<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Juara Lomba Konten Kreator Tanjung Bulan</title>
  <link rel="stylesheet" href="gaya.css" />
  
</head>
<body>

  <h1>🏆 Poin Lomba Konten Kreator Dusun Tanjung Bulan</h1>
  <div id="daftarJuara"></div>

  <footer>© 2025 Tanjung Bulan Cyber™</footer>

  <script src="juara.js"></script>
  <script>
    // ⚙️ STATUS PENILAIAN
    // Pilihan: "tutup" (selesai, tampilkan hasil), atau "belum" (masih proses)
    const statusPenilaian = "belum"; // ubah ke "tutup" jika hasil sudah final

    if (statusPenilaian !== "tutup") {
      const overlay = document.createElement("div");
      overlay.id = "overlay";
      overlay.innerHTML = `
        <div>🕓 Penilaian masih berlangsung.<br>Hasil juara akan diumumkan setelah penilaian selesai.</div>
        <button onclick="window.location.href='https://tiktok.com/@tanjung.bulan'">Lihat TikTok Tanjung Bulan</button>
      `;
      document.body.appendChild(overlay);
    }

    const container = document.getElementById("daftarJuara");

    // 🧩 Buat elemen peserta dari hasilRanking di juara.js
    hasilRanking.forEach((p, i) => {
      // Hapus https:// atau www. dari link
      let cleanLink = p.linkVideo.replace(/^https?:\/\/(www\.)?/i, '');

      const div = document.createElement("div");
      div.className = "peserta";
      div.innerHTML = `
        <div class="rank">#${i + 1}</div>
        <div class="nama">${p.nama.toUpperCase()}</div>
        <div class="nilai">
          💡 Kreatifitas: <span>${p.nilaiKreatif.toFixed(1)}</span><br>
          🏡 Dampak Lokal: <span>${p.nilaiLokal.toFixed(1)}</span><br>
          🚀 Performa Viral: <span>${p.viral.toFixed(1)}</span>
        </div>
        <div class="total" id="total-${i}">0</div>
        <a class="link" href="${p.linkVideo}" target="_blank">🔗 ${cleanLink}</a>
      `;
      container.appendChild(div);
    });

    // 🎞️ Animasi angka bergulir
    function animateValue(el, start, end, duration) {
      const range = end - start;
      let startTime = null;
      function step(timestamp) {
        if (!startTime) startTime = timestamp;
        const progress = Math.min((timestamp - startTime) / duration, 1);
        el.textContent = Math.floor(start + range * progress);
        if (progress < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }

    // 🌊 Efek bergelombang saat scroll
    const pesertaEls = document.querySelectorAll(".peserta");
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry, idx) => {
        if (entry.isIntersecting) {
          const el = entry.target;
          if (!el.classList.contains("show")) {
            setTimeout(() => {
              el.classList.add("show");
              const index = Array.from(pesertaEls).indexOf(el);
              const totalEl = el.querySelector(".total");
              const total = hasilRanking[index].total;
              animateValue(totalEl, 0, total, 3000);
            }, idx * 600); // Delay antar peserta (gelombang)
          }
        }
      });
    }, { threshold: 0.3 });

    pesertaEls.forEach((el) => observer.observe(el));
  </script>

</body>
</html>